<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
	<script type="text/javascript" src="./index.js"></script>
	<script type="text/javascript" src="./getModel.js"></script>
	<!--  // <script type="text/javascript" src="./map.js"></script>  -->
	<link rel="stylesheet" type="text/css" href="./index.css">
	
</head>
<body>

	<h1>Welcome to Angel Trips!</h1>


	<div id="toplevel">
		<input type="text" name="dep_city" id="dep_city"> Departure City<br>
		<input type="text" name="dest_city" id="dest_city"> Destination City<br>
		<button type="button" id="start_search">Start your journey</button>
		<button type="button" id="end_search">Finalize your journey</button>
	</div>

	<div id="map"></div>
	<div id="direction-panel"></div>


	<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB5LyIEhdrka55mYbw5pIHSwDyA-FR82gw&callback=initMap">
	</script>

	<script>

	function initMap() {

		global.directionsService = new google.maps.DirectionsService;
		global.directionsDisplay = new google.maps.DirectionsRenderer;
		var map = new google.maps.Map(document.getElementById('map'), {
			zoom: 6,
			center: {lat: 41.85, lng: -87.65}
		});
		directionsDisplay.setMap(map);

		$("#start_search").click(function(){
			startName = $("#dep_city").val()
			start = coord(startName);
			end = coord($("#dest_city").val());
			origin= new google.maps.LatLng(start[0],start[1]);
			dest = new google.maps.LatLng(end[0],end[1]);
			calculateAndDisplayRoute(startName);

		});



	}


	$(document).ready(function(){
//get start and end point for map
debugger;

var start ;
var end ;
var origin;
var dest ;
var i=0;
var bypass=[];
var directionsService;
var directionsDisplay ;
});




	function calculateAndDisplayRoute(cityName) {
		var wypts;
		if(i!=0){
			wypts= {location: cityName, stopover: true};
			bypass[i-1]=wypts;
		}

		global.i+=1;

		directionsService.route({
    //origin and dest needs to add province to value, otherwise map doesn't work
    origin: origin,
    destination: dest,
    waypoints: bypass,
    optimizeWaypoints: true,
    travelMode: google.maps.TravelMode.DRIVING
}, function(response, status) {
	if (status != google.maps.DirectionsStatus.OK) {
		window.alert('Directions request failed due to ' + status);
	} 
});
	}

	</script>

	<div id="cities">
	</div>

</body>
</html>